\documentclass[12pt]{extarticle}
\usepackage{atbegshi}
\usepackage{pdfpages}
\usepackage[paperwidth=10.2cm, paperheight=5cm, margin=0mm]{geometry}
\usepackage{gregoriotex}
\usepackage{wrapfig}
\input{\CurrentFilePath/../share}
\input{\CurrentFilePath/config}
\input{\CurrentFilePath/page-crop}

\makeatletter
\long\def\nabcsnippet#1{%
  \directlua{gregoriotex.direct_gabc("\luatexluaescapestring{\unexpanded\expandafter{#1}}", "nabc-lines:1;", \gre@allowdeprecated@asboolean)}%
}%
\makeatother

\let\snippet\gabcsnippet
\newcommand{\enableNabc}{%
    \global\let\snippet\nabcsnippet%
}

\newcommand{\linesTrad}[1]{\begin{wrapfigure}[#1]{r}[2mm]{3.5cm}\end{wrapfigure}}

\enablePageCropping

\newcommand{\gabcDisplay}[1]{
	\grechangestyle{initial}{\fontsize{90}{90}\selectfont\decorativ}
	\snippet{#1}
}

\newcommand{\gabcNormal}[1]{
	\grechangestyle{initial}{\fontsize{40}{40}\selectfont\decorativ}
	\gresetinitiallines{1}
	\snippet{#1}
}

\newcommand{\gabcAnnotation}[3]{
	\greannotation{#1}
	\greannotation{#2}
	\grechangedim{annotationraise}{0.5mm}{fixed}
	\gabcNormal{#3}
}

\newcommand{\gabcSimplex}[1]{
	\gresetinitiallines{0}
	\snippet{#1}
}

\newcommand{\gabcAnt}[3][Anti-]{
	\greannotation{#1}
	\greannotation{#2}
	\grechangedim{annotationraise}{-4mm}{scalable}
	\gresetinitiallines{1}
	\grechangestyle{initial}{\color{white}}
	\snippet{#3}
}
