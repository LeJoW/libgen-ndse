\usepackage{pdfpages}
\usepackage{enumitem}
\usepackage{mdframed}
\usepackage{xcolor}

\newcommand*{\pdfnumberofpages}[1]{%
	\directlua{%
		local doc = pdfe.open("\luaescapestring{#1}")
		local pages
		if (doc) then
		pages = pdfe.getnofpages(doc)
		else
		pages = 0
		end
		tex.write(pages)
	}%
}

\newcounter{gabcCount}
\newcommand{\cantus}[1]{
	\setcounter{gabcCount}{0}
	{
		\def\pdfFile{../../content/gabc/build/#1.pdf}
		\setlength{\parindent}{0pt}
		\setlength{\parskip}{4pt}
		\whiledo{\value{gabcCount}<\pdfnumberofpages{\pdfFile}}{
			\stepcounter{gabcCount}
			\includegraphics[page=\thegabcCount]{\pdfFile}
			\par
		}
	}
	\addvspace{4mm}
}

\mdfdefinestyle{floatTradStyle}{
	leftmargin=-1mm,
	rightmargin=-1pt,
	skipabove=5pt,
	innertopmargin=0pt,
	innerleftmargin=2mm,
	innerrightmargin=0pt,
	backgroundcolor=white,
	linecolor=white
}
\newcommand{\cantusTRAD}[2]{
	\addvspace{2mm}
	{
		\fancyhead[RO,LE]{}
		\fancyhead[RE,LO]{\hstyle{\thepage}}
		\fancyhead[CO]{\hstyle{\dayTitleShort}}
		\fancyhead[CE]{\hstyle{\officeTitleShort}}
		\twosided[b]
		\setcolumnwidth{/2mm,3.5cm}
		\setlength\columnseprule{0pt}
		\begin{paracol}{2}
			\tolerance=9999
			\begin{rightcolumn}
				\begin{mdframed}[style=floatTradStyle]\frenchpar{#2}\end{mdframed}
			\end{rightcolumn}
			\begin{leftcolumn}\cantus{#1}\end{leftcolumn}
		\end{paracol}
		\twosided
		\fancyhead[RE,LO]{}
		\fancyhead[RO,LE]{\hstyle{\thepage}}
		\fancyhead[CE]{\hstyle{\dayTitleShort}}
		\fancyhead[CO]{\hstyle{\officeTitleShort}}
	}
}

\newenvironment{psalterium}{}{}

\newenvironment{psalm}{
	\setlength{\parsep}{0pt}
	\setlength{\parskip}{0pt}
}{}

\newenvironment{psalmBody}{
	\begin{colonnes}
		}{
	\end{colonnes}
}

\newcommand{\psalmLA}[1]{\colLA{#1}}
\newcommand{\psalmFR}[1]{\colFR{#1}}
\newcommand{\psalmVerseEnd}{}

\newenvironment{psalmTrad}{
	\begin{tradColonnes}
		}{
	\end{tradColonnes}
}
